---
applyTo: 'modules/home/nixvim/**/*.nix'
---

# LazyVim + NixVim Configuration Guide

The user wants to use Neovim with LazyVim as the plugin manager. To leverage the declarative nature of NixOS, we use NixVim to generate the base Neovim configuration, while allowing dynamic plugin management via LazyVim (hybrid approach).
This allows the user to add/remove plugins and settings without needing to rebuild their entire NixOS configuration.

## Architecture Overview

- **NixVim** manages the base Neovim configuration at `~/.config/nvim/` (read-only, generated from Nix)
- **LazyVim** provides the plugin ecosystem and sensible defaults
- **`~/.config/nvim-local/`** provides a writable directory for dynamic plugin management

- `lazyvim.nix` is used in NixOs configuration
- `not_used_lazyvim.nix` is just a reference file for comparison
- `not_used_relief.nix` is another reference file for comparison

The official LazyVim docs can be found [here](https://www.lazyvim.org/). 
The official LazyVim starter configuration can be found [here](https://github.com/LazyVim/starter).


### Why `nvim-local` instead of standard `~/.config/nvim/lua/plugins/`?

According to [LazyVim docs](https://www.lazyvim.org/configuration), user plugins should go in `~/.config/nvim/lua/plugins/`. However, we can't use this because:

`~/.config/nvim/` is **read-only** and generated by NixOS on every rebuild. Any manual changes to `~/.config/nvim/lua/plugins/` would be **wiped out** on rebuild.

## Directory Structure

```
~/.config/nvim/              # NixVim-generated (read-only)
└── init.lua                 # Generated from lazyvim.nix

~/.config/nvim-local/        # Writable runtime config
└── lua/
    └── user/
        └── specs/
            ├── init.lua       # Aggregates all spec files
            ├── keymaps.lua    # Your custom keymaps and plugin specs
            ├── noice.lua      # Noice plugin configuration
            └── mason-local.lua # Mason LSP configuration

nixos-config/
└── nvim-local/              # Symlink to ~/.config/nvim-local (for agent visibility)
```

## Making nvim-local Visible to the Agent

To allow the agent to see and help with your `~/.config/nvim-local/` files a symlink was created in your `nixos-config` repo.
