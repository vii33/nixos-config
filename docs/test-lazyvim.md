# Testing LazyVim Setup

After rebuilding your system, follow these steps to test the LazyVim configuration:

## 1. Rebuild System

```fish
sudo nixos-rebuild switch --flake .#laptop
```

## 2. Test Basic Neovim Launch

```fish
nvim
```

**First Launch:**
- ‚è≥ Lazy will automatically download LazyVim and all plugins (takes ~1-2 minutes)
- üì¶ You'll see a progress window showing downloads
- ‚úÖ Once complete, neovim will be ready

**Subsequent Launches:**
- ‚úÖ No downloads needed
- ‚úÖ Fast startup
- ‚úÖ LazyVim dashboard or default view
- ‚úÖ Lazy plugin manager is active

## 3. Check Lazy Status

In neovim, press `<Space>l` or type `:Lazy` to open the Lazy plugin manager UI.

You should see:
- LazyVim and all its default plugins listed
- Python language extras (if enabled)
- All plugins in "Loaded" state

## 4. Test LazyVim Features

Try these basic LazyVim commands:
- `<Space>ff` - Find files (Telescope)
- `<Space>e` - Toggle file explorer
- `<Space>gg` - Open lazygit (if installed)
- `:checkhealth` - Check neovim health

## 5. Add a Custom Plugin (Optional)

```fish
# Create a custom plugin spec
mkdir -p ~/.config/nvim-local/lua/user/specs
cat > ~/.config/nvim-local/lua/user/specs/test.lua << 'EOF'
return {
  -- Add vim-startuptime to measure startup performance
  {
    "dstein64/vim-startuptime",
    cmd = "StartupTime",
  },
}
EOF
```

Then in neovim:
```vim
:Lazy sync
:StartupTime
```

## Troubleshooting

### Error: "No specs found"
- Make sure you rebuilt the system after updating lazyvim.nix
- On first launch, wait for all plugins to download
- Check `:Lazy` to see download progress

### Error: "module 'lazyvim.util.format' not found"
- This was fixed by letting Lazy manage LazyVim instead of using nixpkgs
- Make sure you've rebuilt with the latest lazyvim.nix
- Delete old data: `rm -rf ~/.local/share/nvim/lazy/LazyVim` and restart nvim

### Error: "attempt to get length of local 'spec' (a boolean value)"
- This was fixed - make sure you have the latest lazyvim.nix
- The issue was with how user specs were conditionally imported

### Plugins not loading
- Check `:Lazy` to see plugin status
- Try `:Lazy sync` to force a sync
- Check `:messages` for any errors

### Custom specs not loading
- Ensure files are in `~/.config/nvim-local/lua/user/specs/`
- File must end with `.lua`
- Check Lua syntax: `:luafile ~/.config/nvim-local/lua/user/specs/yourfile.lua`
- Restart neovim or run `:Lazy reload`

## Expected Directory Structure After Setup

```
~/.config/
‚îú‚îÄ‚îÄ nvim/                           # Generated by nixvim (read-only)
‚îÇ   ‚îú‚îÄ‚îÄ init.lua                   # Main init file with LazyVim setup
‚îÇ   ‚îî‚îÄ‚îÄ pack/myNeovimPackages/
‚îÇ       ‚îî‚îÄ‚îÄ start/
‚îÇ           ‚îî‚îÄ‚îÄ lazy.nvim/         # Plugin manager (from Nix)
‚îî‚îÄ‚îÄ nvim-local/                    # Your customizations (writable)
    ‚îî‚îÄ‚îÄ lua/
        ‚îî‚îÄ‚îÄ user/
            ‚îî‚îÄ‚îÄ specs/
                ‚îî‚îÄ‚îÄ *.lua          # Your custom plugin specs

~/.local/share/nvim/
‚îî‚îÄ‚îÄ lazy/                          # Plugins managed by Lazy (runtime)
    ‚îú‚îÄ‚îÄ LazyVim/                   # LazyVim distribution
    ‚îú‚îÄ‚îÄ telescope.nvim/            # And all other plugins
    ‚îî‚îÄ‚îÄ ...
```

## Quick Reference

| Command | Description |
|---------|-------------|
| `<Space>l` | Open Lazy UI |
| `:Lazy sync` | Sync all plugins |
| `:Lazy update` | Update plugins |
| `:Lazy clean` | Remove unused plugins |
| `:Lazy profile` | Show plugin load times |
| `:LazyExtras` | Browse available LazyVim extras |
| `:checkhealth lazy` | Check Lazy.nvim health |
